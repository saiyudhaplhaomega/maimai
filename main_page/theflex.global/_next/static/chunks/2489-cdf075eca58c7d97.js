"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2489],{78006:function(e,t,s){s.d(t,{default:function(){return ed}});var a=s(57437),r=s(2265),l=s(7586),o=s(52048),n=s(62869),i=s(37277),c=s(99376),d=s(83774),m=s(31047),h=s(32489),u=s(21047),x=s(95805),p=s(99397),f=s(90740),g=s(27107),y=s(26815),b=s(19060),v=s(85897),j=s(94508),C=s(53647),N=s(74928),w=s(8493),F=s(88685),S=s(57054),k=s(63409),P=s(79294),M=s(96797),A=s(71762),D=s(7310),R=s.n(D),U=s(42936);let z=["Any","0","1","2","3","4+"],E=["Any","1","2","3","4+"],T={london:"search_descriptions.london",paris:"search_descriptions.paris",algiers:"search_descriptions.algiers",lisbon:"search_descriptions.lisbon"};function _(e){let[t,s,a]=e.split("-").map(Number);return new Date(t,s-1,a,12,0,0)}function L(e){let{onSearch:t,defaultValues:s,filters:l,onFilterChange:o,onFilterReset:i,isPropertyListScrolled:D=!1}=e,L=(0,c.useRouter)(),B=(0,c.useSearchParams)(),[Z,q]=(0,r.useState)(!1),{scrollDirection:O,isAtTop:W}=(0,w.C)(),[I,G]=(0,r.useState)(null==s?void 0:s.location),[V,Y]=(0,r.useState)(!1),[X,K]=(0,r.useState)((null==s?void 0:s.guests)||1),{currency:$,formatAmount:Q,convertAmount:H}=(0,P.U)(),{translateText:J,currentLanguage:ee}=(0,M.m)(),{getTranslatedText:et}=(0,U.M1)(),es=(0,r.useMemo)(()=>I&&T[I]?et(T[I]):"",[I,et]),ea=(0,r.useMemo)(()=>({min:Math.round(H(0,"GBP")),max:Math.round(H(1e4,"GBP"))}),[$,H]),er=(0,r.useMemo)(()=>{let e=ea.max-ea.min;return"DZD"===$?Math.max(1e3,Math.round(e/200)):"USD"===$||"EUR"===$?Math.max(5,Math.round(e/500)):Math.max(1,Math.round(e/1e3))},[$,ea]),el=(0,r.useMemo)(()=>{let[e,t]=l.priceRange;return[Math.round(H(e,"GBP")),Math.round(H(t,"GBP"))]},[l.priceRange,$,H]),[eo,en]=(0,r.useState)(()=>{let e=null==B?void 0:B.get("from"),t=null==B?void 0:B.get("to");if(e&&t)return{from:_(e),to:_(t)}}),ei=()=>{let e=new URLSearchParams;(null==eo?void 0:eo.from)&&e.set("from",(0,g.WU)(eo.from,"yyyy-MM-dd")),(null==eo?void 0:eo.to)&&e.set("to",(0,g.WU)(eo.to,"yyyy-MM-dd")),X&&e.set("guests",X.toString()),t(e);let s="".concat(window.location.pathname,"?").concat(e.toString());window.history.replaceState({},"",s)},ec=e=>{K(e),setTimeout(()=>{let s=new URLSearchParams;(null==eo?void 0:eo.from)&&s.set("from",(0,g.WU)(eo.from,"yyyy-MM-dd")),(null==eo?void 0:eo.to)&&s.set("to",(0,g.WU)(eo.to,"yyyy-MM-dd")),s.set("guests",e.toString()),t(s);let a="".concat(window.location.pathname,"?").concat(s.toString());window.history.replaceState({},"",a)},200)},ed=(0,r.useCallback)(()=>{if(X<8){let e=X+1;K(e),ec(e)}},[X,ec]),em=(0,r.useCallback)(()=>{if(X>1){let e=X-1;K(e),ec(e)}},[X,ec]),eh=(e,t)=>{o({...l,[e]:t})},eu=(0,r.useCallback)(R()(e=>{let[t,s]=e;eh("priceRange",[Math.round(H(t,$)),Math.round(H(s,$))])},150),[$,H,eh]),ex=(0,r.useCallback)(e=>{eh("bedrooms",e)},[eh]),ep=(0,r.useCallback)(e=>{eh("bathrooms",e)},[eh]),ef=(0,r.useCallback)((e,t)=>{eh("amenities",{...l.amenities,[e]:t})},[l.amenities,eh]),eg=e=>Q(e,$),ey=()=>({USD:"$",EUR:"€",GBP:"\xa3",DZD:"دج"})[$]||"$";return(0,a.jsxs)("div",{style:{backgroundColor:"#FFFDF6",borderColor:"#5C5C5A20"},className:"border-b",children:[(0,a.jsxs)("div",{className:"p-3",children:[(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),ei()},className:"space-y-3",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-2",children:[(0,a.jsx)("div",{className:"w-full md:w-[26.25%]",children:(0,a.jsxs)(C.Ph,{value:I,onValueChange:e=>{G(e);let t=new URLSearchParams;(null==eo?void 0:eo.from)&&t.set("from",(0,g.WU)(eo.from,"yyyy-MM-dd")),(null==eo?void 0:eo.to)&&t.set("to",(0,g.WU)(eo.to,"yyyy-MM-dd")),X&&t.set("guests",X.toString()),L.push("/short-term-rentals/".concat(e,"?").concat(t.toString()))},children:[(0,a.jsx)(C.i4,{className:"h-9 text-sm touch-manipulation",style:{backgroundColor:"#FFFDF6",borderColor:"#5C5C5A40",color:"#333333"},children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4",style:{color:"#5C5C5A"}}),(0,a.jsx)(C.ki,{placeholder:et("search.where"),children:I?et("common.".concat(I)):et("search.where")})]})}),(0,a.jsx)(C.Bw,{style:{backgroundColor:"#FFFDF6",borderColor:"#5C5C5A40"},children:F.K.map(e=>(0,a.jsx)(C.Ql,{value:e.value,className:"text-sm py-3 px-3 rounded-lg city-select-item touch-manipulation",style:{color:"#333333"},children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:et("common.".concat(e.value))})]})},e.value))})]})}),(0,a.jsx)("div",{className:"w-full md:w-[27.5%]",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)(S.J2,{open:V,onOpenChange:e=>{if(!e&&(null==eo?void 0:eo.from)&&!(null==eo?void 0:eo.to)){Y(!0);return}Y(e)},children:[(0,a.jsx)(S.xo,{asChild:!0,children:(0,a.jsx)(n.z,{variant:"outline",className:(0,j.cn)("h-9 w-full justify-start text-left font-normal text-sm touch-manipulation",!eo&&"text-muted-foreground"),style:{backgroundColor:"#FFFDF6",borderColor:"#5C5C5A40",color:eo?"#333333":"#5C5C5A"},children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4",style:{color:"#5C5C5A"}}),(null==eo?void 0:eo.from)?eo.to?(0,a.jsx)(a.Fragment,{children:(0,A.W7)(eo.from,eo.to)}):(0,g.WU)(eo.from,"MMM dd"):(0,a.jsx)("span",{children:et("search.dates")})]})})}),(0,a.jsxs)(S.yk,{className:"w-auto p-0",align:"start",style:{backgroundColor:"#FFFDF6",borderColor:"#5C5C5A40"},children:[(0,a.jsxs)("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"#5C5C5A20"},children:[(0,a.jsx)("h3",{className:"font-medium text-sm",style:{color:"#333333"},children:et("search.select_dates")}),eo&&(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>{en(void 0),Y(!1);let e=new URLSearchParams;X&&e.set("guests",X.toString()),t(e);let s="".concat(window.location.pathname,"?").concat(e.toString());window.history.replaceState({},"",s)},className:"h-6 px-2 text-xs hover:bg-red-50 hover:text-red-600 touch-manipulation",style:{color:"#5C5C5A"},children:et("search.clear")})]}),(0,a.jsx)(k.f,{initialFocus:!0,mode:"range",defaultMonth:(null==eo?void 0:eo.from)||new Date,selected:eo,onSelect:e=>{en(e),(null==e?void 0:e.from)&&(null==e?void 0:e.to)&&(Y(!1),setTimeout(()=>{let s=new URLSearchParams;s.set("from",(0,g.WU)(e.from,"yyyy-MM-dd")),s.set("to",(0,g.WU)(e.to,"yyyy-MM-dd")),X&&s.set("guests",X.toString()),t(s);let a="".concat(window.location.pathname,"?").concat(s.toString());window.history.replaceState({},"",a)},50))},numberOfMonths:2,fromDate:new Date,className:"touch-manipulation"})]})]}),eo&&(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>{en(void 0);let e=new URLSearchParams;X&&e.set("guests",X.toString()),t(e);let s="".concat(window.location.pathname,"?").concat(e.toString());window.history.replaceState({},"",s)},className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-7 w-7 p-0 hover:bg-red-50 hover:text-red-600 touch-manipulation",style:{color:"#5C5C5A"},children:(0,a.jsx)(h.Z,{className:"h-3 w-3"})})]})}),(0,a.jsx)("div",{className:"w-full md:w-[23.125%]",children:(0,a.jsxs)("div",{className:"flex items-center h-9 border rounded-md",style:{backgroundColor:"#FFFDF6",borderColor:"#5C5C5A40"},children:[(0,a.jsx)(n.z,{type:"button",variant:"ghost",size:"sm",onClick:em,className:"h-7 w-7 p-0 hover:bg-gray-100 touch-manipulation",disabled:X<=1,children:(0,a.jsx)(u.Z,{className:"h-3 w-3"})}),(0,a.jsxs)("div",{className:"flex-1 flex items-center justify-center gap-2",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4",style:{color:"#5C5C5A"}}),(0,a.jsxs)("span",{className:"text-sm",style:{color:"#333333"},children:[X," ",1===X?et("property.guest"):et("property.guests")]})]}),(0,a.jsx)(n.z,{type:"button",variant:"ghost",size:"sm",onClick:ed,className:"h-7 w-7 p-0 hover:bg-gray-100 touch-manipulation",disabled:X>=8,children:(0,a.jsx)(p.Z,{className:"h-3 w-3"})})]})}),(0,a.jsx)("div",{className:"w-full md:w-[23.125%]",children:(0,a.jsxs)(n.z,{type:"button",variant:"outline",size:"sm",onClick:()=>q(!Z),className:"h-9 text-xs w-full touch-manipulation",style:{backgroundColor:Z?"#284E4C20":"#FFFDF6",borderColor:"#5C5C5A40",color:Z?"#284E4C":"#5C5C5A"},children:[(0,a.jsx)(f.Z,{className:"h-3 w-3 mr-1"}),et("search.filters")]})})]})}),I&&es&&(0,a.jsx)("div",{className:(0,j.cn)("mt-4 px-2 transition-all duration-300","down"===O||D?"opacity-0 max-h-0 overflow-hidden":"opacity-100 max-h-20"),children:(0,a.jsx)("p",{className:"leading-relaxed",style:{fontFamily:"Helvetica Neue",fontWeight:400,fontSize:"12px",fontStyle:"normal",letterSpacing:"0px",color:"#5C5C5A",textAlign:"left",verticalAlign:"top"},children:es})})]}),(0,a.jsx)(N.zF,{open:Z,onOpenChange:q,children:(0,a.jsx)(N.Fw,{children:(0,a.jsx)("div",{className:"border-t p-3",style:{borderColor:"#5C5C5A20",backgroundColor:"#FFFDF650"},children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(y._,{className:"text-xs font-medium",style:{color:"#333333"},children:[et("search.price_range")," (",$,")"]}),(0,a.jsxs)("div",{className:"text-xs",style:{color:"#5C5C5A"},children:[eg(el[0])," - ",eg(el[1])]})]}),(0,a.jsxs)("div",{className:"px-2",children:[(0,a.jsx)(v.i,{value:el,onValueChange:e=>{eu(e)},min:ea.min,max:ea.max,step:er,className:"w-full touch-manipulation"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs mt-3",style:{color:"#5C5C5A"},children:[(0,a.jsxs)("span",{children:[ey(),ea.min.toLocaleString()]}),(0,a.jsxs)("span",{children:[ey(),ea.max.toLocaleString()]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(y._,{className:"text-xs font-medium",style:{color:"#333333"},children:et("search.bedrooms")}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-1",children:z.map(e=>(0,a.jsx)(n.z,{type:"button",variant:l.bedrooms===e?"default":"outline",size:"sm",onClick:()=>ex(e),className:"h-7 text-xs px-2 touch-manipulation",style:{backgroundColor:l.bedrooms===e?"#284E4C":"#FFFDF6",borderColor:"#5C5C5A40",color:l.bedrooms===e?"#FFFDF6":"#333333"},children:"Any"===e?et("search.any"):e},e))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(y._,{className:"text-xs font-medium",style:{color:"#333333"},children:et("search.bathrooms")}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-1",children:E.map(e=>(0,a.jsx)(n.z,{type:"button",variant:l.bathrooms===e?"default":"outline",size:"sm",onClick:()=>ep(e),className:"h-7 text-xs px-2 touch-manipulation",style:{backgroundColor:l.bathrooms===e?"#284E4C":"#FFFDF6",borderColor:"#5C5C5A40",color:l.bathrooms===e?"#FFFDF6":"#333333"},children:"Any"===e?et("search.any"):e},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(y._,{className:"text-xs font-medium",style:{color:"#333333"},children:et("search.amenities")}),(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Object.entries(l.amenities).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(b.X,{id:t,checked:s,onCheckedChange:e=>ef(t,!!e),className:"h-3 w-3 touch-manipulation",style:{borderColor:"#5C5C5A40"}}),(0,a.jsx)(y._,{htmlFor:t,className:"text-xs capitalize",style:{color:"#333333"},children:et("search.".concat(t))})]},t)})})]}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:i,className:"w-full h-7 text-xs touch-manipulation",style:{backgroundColor:"#FFFDF6",borderColor:"#5C5C5A40",color:"#5C5C5A"},children:et("search.reset_filters")})]})})})})]})}var B=s(5095),Z=s(58130),q=s(36805),O=s(91128),W=s(43299);function I(e){let{properties:t,selectedProperty:s,onSelectProperty:l,formatPrice:o}=e;(0,c.useRouter)();let n=(0,c.usePathname)(),i=(0,c.useSearchParams)(),{translateBatch:d,currentLanguage:m}=(0,M.m)(),{getTranslatedText:h}=(0,U.M1)(),[u,p]=(0,r.useState)(t),f=(0,r.useRef)(new Map),g=(0,r.useRef)(!1),y=(0,r.useMemo)(()=>t.map(e=>"".concat(e.id,"-").concat(e.listingName,"-").concat(e.city)).join("|"),[t]),b=(0,r.useMemo)(()=>{if("en"===m)return t;let e="".concat(m,"-").concat(y);return f.current.has(e)?f.current.get(e):u},[t,m,y,u]);(0,r.useEffect)(()=>{if(p(t),"en"===m||0===t.length)return;let e="".concat(m,"-").concat(y);if(f.current.has(e)){p(f.current.get(e));return}if(g.current)return;let s=setTimeout(async()=>{g.current=!0;try{let s=t.flatMap(e=>[e.listingName||"Unnamed Property",e.city||"Unknown Location"]),a=await d(s),r=t.map((e,t)=>({...e,translatedListingName:a[2*t]||e.listingName,translatedCity:a[2*t+1]||e.city}));f.current.set(e,r),p(r)}catch(e){console.error("Error translating property data:",e)}finally{g.current=!1}},100);return()=>{clearTimeout(s),g.current=!1}},[t,m,d,y]);let v=null==i?void 0:i.get("from"),j=null==i?void 0:i.get("to"),C=v&&j?Math.ceil((new Date(j).getTime()-new Date(v).getTime())/864e5):null,N=e=>{let t=(0,q.mS)(n),s=t&&"en"!==t?"/".concat(t,"/property/").concat(e):"/property/".concat(e),a=new URLSearchParams;(null==i?void 0:i.has("from"))&&a.set("from",i.get("from")),(null==i?void 0:i.has("to"))&&a.set("to",i.get("to")),(null==i?void 0:i.has("guests"))&&a.set("guests",i.get("guests")),(null==i?void 0:i.has("minPrice"))&&a.set("minPrice",i.get("minPrice")),(null==i?void 0:i.has("maxPrice"))&&a.set("maxPrice",i.get("maxPrice")),(null==i?void 0:i.has("bedrooms"))&&a.set("bedrooms",i.get("bedrooms")),(null==i?void 0:i.has("bathrooms"))&&a.set("bathrooms",i.get("bathrooms")),(null==i?void 0:i.has("amenities"))&&a.set("amenities",i.get("amenities"));let r=a.toString();return r?"".concat(s,"?").concat(r):s},w=(e,t)=>{localStorage.setItem("bookingPropertyName",e.listingName);let s=N(e.id);t&&(t.ctrlKey||t.metaKey||1===t.button)?window.open(s,"_blank","noopener,noreferrer"):window.location.href=s},F=(e,t)=>{let s=t.touches[0],a=t.currentTarget;a.dataset.touchStartX=s.clientX.toString(),a.dataset.touchStartY=s.clientY.toString(),a.dataset.touchStartTime=Date.now().toString(),a.dataset.hasMoved="false"},S=e=>{let t=e.touches[0],s=e.currentTarget,a=parseFloat(s.dataset.touchStartX||"0"),r=parseFloat(s.dataset.touchStartY||"0"),l=Math.abs(t.clientX-a),o=Math.abs(t.clientY-r);Math.sqrt(l*l+o*o)>15&&(s.dataset.hasMoved="true")},k=(e,t)=>{t.preventDefault(),t.stopPropagation();let s=t.currentTarget,a="true"===s.dataset.hasMoved,r=parseInt(s.dataset.touchStartTime||"0"),l=Date.now()-r;!a&&l<500&&w(e),delete s.dataset.touchStartX,delete s.dataset.touchStartY,delete s.dataset.touchStartTime,delete s.dataset.hasMoved};return 0===t.length?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-xl mb-4",style:{color:"#5C5C5A"},children:h("No properties to display")})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pb-[50vh] lg:pb-0",children:(0,a.jsx)(B.M,{mode:"popLayout",children:b.map((e,t)=>{let r,l;if(e.calculatedPrice&&C)r=e.calculatedPrice,l=1===C?"for 1 night":"for ".concat(C," nights");else if(e.calendarData&&e.calendarData.length>0)r=e.calendarData.reduce((e,t)=>e+t.price,0),l=1===e.calendarData.length?"for 1 night":"for ".concat(e.calendarData.length," nights");else{let t=Math.round(e.monthPrice/30);r=C?t*C:t,l=C?1===C?"for 1 night":"for ".concat(C," nights"):"per night"}let n=o(r,e.currency),i=e.images&&e.images.length>0?e.images[0].url:"https://via.placeholder.com/800x600?text=No+Image";return(0,a.jsx)(Z.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:.05*t},className:"group rounded-xl overflow-hidden shadow-lg cursor-pointer transition-all hover:shadow-xl hover:scale-[1.02] ".concat((null==s?void 0:s.id)===e.id?"ring-2":""),style:{backgroundColor:"#FFFDF6",ringColor:(null==s?void 0:s.id)===e.id?"#284E4C":"transparent"},children:(0,a.jsxs)("a",{href:N(e.id),onClick:t=>{t.preventDefault(),w(e,t)},onTouchStart:t=>F(e,t),onTouchMove:S,onTouchEnd:t=>k(e,t),onMouseDown:t=>{1===t.button&&(t.preventDefault(),w(e,t))},className:"block w-full h-full touch-manipulation",style:{touchAction:"manipulation"},children:[(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)("div",{className:"relative pb-[56.25%]",children:[(0,a.jsx)("img",{src:i,alt:e.listingName||"Property",className:"absolute inset-0 w-full h-full object-cover",onError:e=>{e.currentTarget.src="https://via.placeholder.com/800x600?text=No+Image"}}),(0,a.jsx)("div",{className:"absolute top-2 right-1",children:(0,a.jsx)("div",{className:"backdrop-blur-sm rounded-md shadow-lg border",style:{backgroundColor:"#FFFDF6F0",borderColor:"#5C5C5A20"},children:(0,a.jsx)("div",{className:"px-1.5 py-0.5",children:(0,a.jsxs)("div",{className:"flex flex-col items-end",children:[(0,a.jsx)("div",{className:"flex items-baseline gap-0.5",children:(0,a.jsx)("span",{className:"text-base font-bold",style:{color:"#284E4C"},children:n})}),(0,a.jsx)("span",{className:"text-[10px]",style:{color:"#5C5C5A"},children:h(l)})]})})})})]})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold break-words hyphens-auto mb-2",style:{color:"#333333"},children:e.translatedListingName||e.listingName||"Unnamed Property"}),(0,a.jsx)("p",{className:"text-sm mb-3",style:{color:"#5C5C5A"},children:e.translatedCity||e.city||"Unknown Location"}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-xs",style:{color:"#5C5C5A"},children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(O.Z,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:[e.totalBedrooms||0," ",1===(e.totalBedrooms||0)?h("property.bedroom"):h("property.bedrooms")]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(W.Z,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:[e.totalBathrooms||0," ",1===(e.totalBathrooms||0)?h("property.bathroom"):h("property.bathrooms")]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(x.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:h("property.up_to_guests").replace("{count}",String(e.personCapacity||e.guestsAllowed||1))})]})]})]})]})},e.id)})})})}var G=s(83464);let V=G.Z.create({baseURL:"/api/listings",headers:{Accept:"application/json","Content-Type":"application/json"}});var Y=s(86978),X=s(35363),K=s(17814),$=s(19378);function Q(e){let[t,s,a]=e.split("-").map(Number);return new Date(t,s-1,a,12,0,0)}let H=["Any","0","1","2","3","4+"],J=["Any","1","2","3","4+"];function ee(e){var t,s;let l;let{onSearch:o,defaultValues:i,filters:u,onFilterChange:p,onFilterReset:f}=e,j=(0,c.useRouter)(),N=(0,c.useSearchParams)(),[w,M]=(0,r.useState)(!1),[D,R]=(0,r.useState)(null==i?void 0:i.location),[z,E]=(0,r.useState)(!1),[T,_]=(0,r.useState)((null==i?void 0:null===(t=i.guests)||void 0===t?void 0:t.toString())||"1"),[L,B]=(0,r.useState)(!1),[Z,q]=(0,r.useState)(!1),{currency:O,formatAmount:W,convertAmount:I}=(0,P.U)(),{getTranslatedText:G}=(0,U.M1)(),V=(0,r.useMemo)(()=>["search.where","search.dates","search.select_dates","search.clear","search.filters","search.price_range","search.bedrooms","search.bathrooms","search.amenities","search.any","search.reset","search.apply_filters","search.elevator","search.balcony","search.dishwasher","common.london","common.paris","common.algiers","common.lisbon"],[]),Y=(0,r.useMemo)(()=>{let e={};return V.forEach(t=>{e[t]=G(t)}),e},[V,G]),ee=(0,r.useCallback)(e=>Y[e]||e,[Y]),et=(0,r.useMemo)(()=>({min:Math.round(I(0,"GBP")),max:Math.round(I(1e4,"GBP"))}),[O,I]),es=(0,r.useMemo)(()=>{let e=et.max-et.min;return"DZD"===O?Math.max(1e3,Math.round(e/200)):"USD"===O||"EUR"===O?Math.max(5,Math.round(e/500)):Math.max(1,Math.round(e/1e3))},[O,et]),ea=(0,r.useMemo)(()=>{let[e,t]=u.priceRange;return[Math.round(I(e,"GBP")),Math.round(I(t,"GBP"))]},[u.priceRange,O,I]),[er,el]=(0,r.useState)(()=>{let e=null==N?void 0:N.get("from"),t=null==N?void 0:N.get("to");if(e&&t)return{from:Q(e),to:Q(t)}}),eo=(0,r.useCallback)(e=>{if(el(e),(null==e?void 0:e.from)&&(null==e?void 0:e.to)){E(!1);let t=new URLSearchParams;t.set("from",(0,g.WU)(e.from,"yyyy-MM-dd")),t.set("to",(0,g.WU)(e.to,"yyyy-MM-dd")),T&&t.set("guests",T),o(t);let s="".concat(window.location.pathname,"?").concat(t.toString());window.history.replaceState({},"",s)}},[T,o]),en=(0,r.useCallback)(e=>{_(e);let t=new URLSearchParams;(null==er?void 0:er.from)&&t.set("from",(0,g.WU)(er.from,"yyyy-MM-dd")),(null==er?void 0:er.to)&&t.set("to",(0,g.WU)(er.to,"yyyy-MM-dd")),t.set("guests",e),o(t);let s="".concat(window.location.pathname,"?").concat(t.toString());window.history.replaceState({},"",s)},[er,o]),ei=(0,r.useCallback)(e=>{R(e);let t=new URLSearchParams;(null==er?void 0:er.from)&&t.set("from",(0,g.WU)(er.from,"yyyy-MM-dd")),(null==er?void 0:er.to)&&t.set("to",(0,g.WU)(er.to,"yyyy-MM-dd")),T&&t.set("guests",T),j.push("/short-term-rentals/".concat(e,"?").concat(t.toString()))},[er,T,j]),ec=(e,t)=>{p({...u,[e]:t})},ed=(0,r.useCallback)((s=e=>{let[t,s]=e;ec("priceRange",[Math.round(I(t,O)),Math.round(I(s,O))])},function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];clearTimeout(l),l=setTimeout(()=>s(...t),300)}),[O,I,ec]),em=e=>W(e,O),eh=()=>({USD:"$",EUR:"€",GBP:"\xa3",DZD:"دج"})[O]||"$",eu=(0,r.useMemo)(()=>{let e=Object.values(u.amenities).some(Boolean),t=u.priceRange[0]>0||u.priceRange[1]<1e4,s="Any"!==u.bedrooms||"Any"!==u.bathrooms;return e||t||s},[u]);(0,r.useCallback)(e=>{ec("bedrooms",e)},[ec]),(0,r.useCallback)(e=>{ec("bathrooms",e)},[ec]),(0,r.useCallback)((e,t)=>{ec("amenities",{...u.amenities,[e]:t})},[u.amenities,ec]);let ex=(0,r.useCallback)(e=>ee("common.".concat(e)).split(",")[0].trim(),[ee]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"p-3 space-y-3",style:{backgroundColor:"#FFFDF6"},children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsxs)(C.Ph,{value:D,onValueChange:ei,children:[(0,a.jsx)(C.i4,{className:"h-10 text-sm border-0 shadow-sm touch-manipulation active:scale-95 transition-transform",style:{backgroundColor:"#FFF9E9",borderColor:"#5C5C5A20",color:"#333333"},children:(0,a.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 flex-shrink-0",style:{color:"#5C5C5A"}}),(0,a.jsx)(C.ki,{placeholder:ee("search.where"),children:(0,a.jsx)("span",{className:"truncate",children:D?ex(D):ee("search.where")})})]})}),(0,a.jsx)(C.Bw,{style:{backgroundColor:"#FFFDF6",borderColor:"#5C5C5A40"},children:F.K.map(e=>(0,a.jsx)(C.Ql,{value:e.value,className:"text-sm touch-manipulation active:bg-gray-100",style:{color:"#333333"},children:ex(e.value)},e.value))})]})}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsxs)(S.J2,{open:z,onOpenChange:e=>{if(!e&&(null==er?void 0:er.from)&&!(null==er?void 0:er.to)){E(!0);return}E(e)},children:[(0,a.jsx)(S.xo,{asChild:!0,children:(0,a.jsx)(n.z,{variant:"outline",className:"h-10 w-full justify-start text-left font-normal text-sm border-0 shadow-sm touch-manipulation active:scale-95 transition-transform",style:{backgroundColor:"#FFF9E9",borderColor:"#5C5C5A20",color:er?"#333333":"#5C5C5A"},children:(0,a.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,a.jsx)("span",{className:"truncate",children:(null==er?void 0:er.from)?er.to?(0,A.W7)(er.from,er.to):(0,g.WU)(er.from,"MMM dd"):ee("search.dates")})]})})}),(0,a.jsxs)(S.yk,{className:"w-auto p-0",align:"start",style:{backgroundColor:"#FFFDF6",borderColor:"#5C5C5A40"},children:[(0,a.jsxs)("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"#5C5C5A20"},children:[(0,a.jsx)("h3",{className:"font-medium text-sm",style:{color:"#333333"},children:ee("search.select_dates")}),er&&(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>{el(void 0),E(!1);let e=new URLSearchParams;T&&e.set("guests",T),o(e);let t="".concat(window.location.pathname,"?").concat(e.toString());window.history.replaceState({},"",t)},className:"h-6 px-2 text-xs hover:bg-red-50 hover:text-red-600 touch-manipulation active:scale-95",style:{color:"#5C5C5A"},children:ee("search.clear")})]}),(0,a.jsx)(k.f,{initialFocus:!0,mode:"range",defaultMonth:(null==er?void 0:er.from)||new Date,selected:er,onSelect:eo,numberOfMonths:1,fromDate:new Date,className:"touch-manipulation"})]})]})}),(0,a.jsx)("div",{className:"w-24",children:(0,a.jsxs)(C.Ph,{value:T,onValueChange:en,children:[(0,a.jsx)(C.i4,{className:"h-10 text-sm border-0 shadow-sm touch-manipulation active:scale-95 transition-transform",style:{backgroundColor:"#FFF9E9",borderColor:"#5C5C5A20",color:"#333333"},children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4",style:{color:"#5C5C5A"}}),(0,a.jsx)(C.ki,{})]})}),(0,a.jsx)(C.Bw,{style:{backgroundColor:"#FFF9E9",borderColor:"#5C5C5A40"},children:(0,a.jsx)($.x,{className:"h-[200px]",children:Array.from({length:15},(e,t)=>t+1).map(e=>(0,a.jsx)(C.Ql,{value:String(e),className:"text-sm cursor-pointer touch-manipulation active:bg-gray-100",style:{color:"#333333"},children:e},e))})})]})}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>M(!0),className:"h-10 px-3 border-0 shadow-sm relative touch-manipulation active:scale-95 transition-transform",style:{backgroundColor:"#FFF9E9",borderColor:"#5C5C5A20",color:"#5C5C5A"},children:[(0,a.jsx)(X.Z,{className:"h-4 w-4"}),eu&&(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 rounded-full",style:{backgroundColor:"#284E4C"}})]})]})}),(0,a.jsx)(K.dy,{open:w,onOpenChange:M,children:(0,a.jsxs)(K.sc,{className:"h-[90vh]",style:{backgroundColor:"#FFFDF6"},children:[(0,a.jsx)(K.OX,{className:"border-b",style:{borderColor:"#5C5C5A20"},children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(K.iI,{style:{color:"#333333"},children:ee("search.filters")}),(0,a.jsx)(K.uh,{asChild:!0,children:(0,a.jsx)(n.z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 touch-manipulation active:scale-95",children:(0,a.jsx)(h.Z,{className:"h-4 w-4"})})})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(y._,{className:"text-base font-medium",style:{color:"#333333"},children:[ee("search.price_range")," (",O,")"]}),(0,a.jsxs)("div",{className:"text-sm",style:{color:"#5C5C5A"},children:[em(ea[0])," - ",em(ea[1])]})]}),(0,a.jsxs)("div",{className:"px-2",children:[(0,a.jsx)(v.i,{value:ea,onValueChange:e=>{let[t,s]=e,a=I(t,O),r=I(s,O);p({...u,priceRange:[Math.round(a),Math.round(r)]}),ed(e)},min:et.min,max:et.max,step:es,className:"w-full touch-manipulation"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs mt-3",style:{color:"#5C5C5A"},children:[(0,a.jsxs)("span",{children:[eh(),et.min.toLocaleString()]}),(0,a.jsxs)("span",{children:[eh(),et.max.toLocaleString()]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(y._,{className:"text-base font-medium",style:{color:"#333333"},children:ee("search.bedrooms")}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:H.map(e=>(0,a.jsx)(n.z,{type:"button",variant:u.bedrooms===e?"default":"outline",size:"sm",onClick:()=>ec("bedrooms",e),className:"h-10 text-sm touch-manipulation active:scale-95 transition-transform",style:{backgroundColor:u.bedrooms===e?"#284E4C":"#FFFDF6",borderColor:"#5C5C5A40",color:u.bedrooms===e?"#FFFDF6":"#333333"},children:"Any"===e?ee("search.any"):e},e))})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(y._,{className:"text-base font-medium",style:{color:"#333333"},children:ee("search.bathrooms")}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:J.map(e=>(0,a.jsx)(n.z,{type:"button",variant:u.bathrooms===e?"default":"outline",size:"sm",onClick:()=>ec("bathrooms",e),className:"h-10 text-sm touch-manipulation active:scale-95 transition-transform",style:{backgroundColor:u.bathrooms===e?"#284E4C":"#FFFDF6",borderColor:"#5C5C5A40",color:u.bathrooms===e?"#FFFDF6":"#333333"},children:"Any"===e?ee("search.any"):e},e))})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(y._,{className:"text-base font-medium",style:{color:"#333333"},children:ee("search.amenities")}),(0,a.jsx)("div",{className:"space-y-3",children:Object.entries(u.amenities).map(e=>{let[t,s]=e;return(0,a.jsxs)("label",{className:"flex items-center justify-between p-3 rounded-lg border touch-manipulation active:bg-gray-50 cursor-pointer transition-colors",style:{borderColor:"#5C5C5A20",backgroundColor:"#FFF9E9"},children:[(0,a.jsx)("span",{className:"text-sm capitalize font-medium",style:{color:"#333333"},children:ee("search.".concat(t))}),(0,a.jsx)(b.X,{checked:s,onCheckedChange:e=>ec("amenities",{...u.amenities,[t]:e}),className:"h-5 w-5 touch-manipulation",style:{borderColor:"#5C5C5A40"}})]},t)})})]})]}),(0,a.jsx)(K.ze,{className:"border-t",style:{borderColor:"#5C5C5A20"},children:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:f,className:"flex-1 h-12 touch-manipulation active:scale-95 transition-transform",style:{backgroundColor:"#FFFDF6",borderColor:"#5C5C5A40",color:"#5C5C5A"},children:ee("search.reset")}),(0,a.jsx)(n.z,{onClick:()=>M(!1),className:"flex-1 h-12 touch-manipulation active:scale-95 transition-transform",style:{backgroundColor:"#284E4C",color:"#FFFDF6"},children:ee("search.apply_filters")})]})})]})})]})}var et=s(98108),es=s(47307),ea=s(40875);let er=es.fC,el=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(es.ck,{ref:t,className:(0,j.cn)("border-b",s),...r})});el.displayName="AccordionItem";let eo=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsx)(es.h4,{className:"flex",children:(0,a.jsxs)(es.xz,{ref:t,className:(0,j.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",s),...l,children:[r,(0,a.jsx)(ea.Z,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})});eo.displayName=es.xz.displayName;let en=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsx)(es.VY,{ref:t,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...l,children:(0,a.jsx)("div",{className:(0,j.cn)("pb-4 pt-0",s),children:r})})});function ei(e){let{city:t}=e,{getTranslatedText:s}=(0,U.M1)(),r=t.toLowerCase(),l=s("cities.".concat(r,".search_title")),o=s("cities.".concat(r,".search_description1")),n=s("cities.".concat(r,".search_description2")),i=[{question:s("cities.".concat(r,".faq1_question")),answer:s("cities.".concat(r,".faq1_answer"))},{question:s("cities.".concat(r,".faq2_question")),answer:s("cities.".concat(r,".faq2_answer"))},{question:s("cities.".concat(r,".faq3_question")),answer:s("cities.".concat(r,".faq3_answer"))},{question:s("cities.".concat(r,".faq4_question")),answer:s("cities.".concat(r,".faq4_answer"))},{question:s("cities.".concat(r,".faq5_question")),answer:s("cities.".concat(r,".faq5_answer"))}];return(0,a.jsx)("div",{className:"w-full py-12 px-4 md:px-6 lg:px-8",style:{backgroundColor:"#FFFDF7"},children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsx)("h2",{className:"text-2xl md:text-3xl font-bold mb-8 text-[#333333]",children:l}),(0,a.jsxs)("div",{className:"space-y-4 mb-12",children:[(0,a.jsx)("p",{className:"text-[#5C5C5A] leading-relaxed",children:o}),(0,a.jsx)("p",{className:"text-[#5C5C5A] leading-relaxed",children:n})]}),(0,a.jsxs)("div",{className:"mt-12",children:[(0,a.jsx)("h3",{className:"text-xl md:text-2xl font-semibold mb-6 text-[#333333]",children:s("common.faqs")}),(0,a.jsx)(er,{type:"single",collapsible:!0,className:"w-full",children:i.map((e,t)=>(0,a.jsxs)(el,{value:"item-".concat(t),className:"border-b border-[#5C5C5A20]",children:[(0,a.jsx)(eo,{className:"text-left py-4 hover:no-underline text-[#333333] hover:text-[#284E4C]",children:e.question}),(0,a.jsx)(en,{className:"text-[#5C5C5A] pb-4",children:e.answer})]},t))})]})]})})}function ec(){let{initialCity:e,initialSearchParams:t,initialProperties:s=[],isHydrated:d=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},m=(0,c.useParams)(),[h,u]=(0,r.useState)(!1),[x,p]=(0,r.useState)("list"),{scrollDirection:f}=(0,w.C)(),[g,y]=(0,r.useState)(null),[b,v]=(0,r.useState)(!1),[C,N]=(0,r.useState)(!1),S=(0,r.useRef)(null),{getTranslatedText:k}=(0,U.M1)(),{filteredProperties:M,loading:A,error:D,selectedProperty:R,filters:z,searchParams:E,setSelectedProperty:T,handleSearch:_,handleFilterChange:B,handleFilterReset:Z,formatPrice:q,fetchProperties:O,setProperties:W}=function(){(0,c.useParams)();let e=(0,c.useSearchParams)(),{currency:t,setCurrency:s,formatAmount:a,convertAmount:l}=(0,P.U)(),[o,n]=(0,r.useState)([]),[i,d]=(0,r.useState)(!1),[m,h]=(0,r.useState)(null),[u,x]=(0,r.useState)(null),[p,f]=(0,r.useState)(()=>{let t=null==e?void 0:e.get("minPrice"),s=null==e?void 0:e.get("maxPrice"),a=(null==e?void 0:e.get("bedrooms"))||"Any",r=(null==e?void 0:e.get("bathrooms"))||"Any",l=null==e?void 0:e.get("amenities");return{priceRange:[t?parseInt(t):0,s?parseInt(s):1e4],amenities:{elevator:(null==l?void 0:l.includes("elevator"))||!1,balcony:(null==l?void 0:l.includes("balcony"))||!1,dishwasher:(null==l?void 0:l.includes("dishwasher"))||!1},bedrooms:a,bathrooms:r}}),g=(0,r.useCallback)((e,t)=>a(e,t),[a]),y=(0,r.useCallback)(async e=>{var t,s,a,r;if(e)try{d(!0),h(null);let a=new URLSearchParams,r=null==e?void 0:null===(t=e.get("city"))||void 0===t?void 0:t.toString().toLowerCase();if(r&&a.set("city",r),e.has("from")){let t=new Date(e.get("from"));a.set("from",t.toISOString().split("T")[0])}if(e.has("to")){let t=new Date(e.get("to"));a.set("to",t.toISOString().split("T")[0])}e.has("guests")&&a.set("guests",e.get("guests")),console.log("[usePropertySearch] Fetching with params:",Object.fromEntries(a.entries()));let l=await V.get("",{params:a});console.log("[usePropertySearch] API Response received:",l.status,l.data);let{data:o}=l,i=Array.isArray(null===(s=o.data)||void 0===s?void 0:s.properties)?o.data.properties:Array.isArray(o.data)?o.data:[];console.log("[usePropertySearch] Raw properties from API:",i.length,i);let c=i.map(e=>{let t;try{t="string"==typeof e.amenities?JSON.parse(e.amenities):e.amenities}catch(s){console.warn("Failed to parse amenities for property",e.id,s),t=[]}return{...e,amenities:t}});console.log("[usePropertySearch] Setting processed properties:",c.length,c),n(c)}catch(t){console.error("[Search] Error fetching properties:",{error:t,params:Object.fromEntries(e.entries())}),G.Z.isAxiosError(t)?h((null===(r=t.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.error)||"Failed to fetch properties"):h("An unexpected error occurred"),n([])}finally{d(!1)}},[]);return{filteredProperties:o.filter(t=>{let s;if(!t)return!1;if(t.calculatedPrice){let e=t.currency||"GBP";l(t.calculatedPrice,e)}else if(t.calendarData&&t.calendarData.length>0)l(t.calendarData.reduce((e,t)=>e+t.price,0),t.currency||"GBP");else{let e=t.currency||"GBP";l(Math.round(t.monthPrice/30),e)}let[a,r]=p.priceRange,o=null==e?void 0:e.get("from"),n=null==e?void 0:e.get("to"),i=o&&n?Math.ceil((new Date(n).getTime()-new Date(o).getTime())/864e5):1,c=a,d=r;t.calculatedPrice||t.calendarData||(c=i>1?a*i:a,d=i>1?r*i:r);let m=t.currency||"GBP",h=l(c,m),u=l(d,m);if(t.calculatedPrice?s=t.calculatedPrice:t.calendarData&&t.calendarData.length>0?s=t.calendarData.reduce((e,t)=>e+t.price,0):(s=Math.round(t.monthPrice/30),i>1&&(s*=i)),s<h||s>u)return!1;if("Any"!==p.bedrooms){if("4+"===p.bedrooms){if(t.totalBedrooms<4)return!1}else{let e=parseInt(p.bedrooms);if(t.totalBedrooms!==e)return!1}}if("Any"!==p.bathrooms){if("4+"===p.bathrooms){if(t.totalBathrooms<4)return!1}else if(t.totalBathrooms!==parseInt(p.bathrooms))return!1}let x=Object.entries(p.amenities).filter(e=>{let[t,s]=e;return s}).map(e=>{let[t]=e;return t});if(x.length>0){let e=Array.isArray(t.amenities)?t.amenities:[];return x.every(t=>e.some(e=>e.amenityName.toLowerCase().includes(t.toLowerCase())))}return!0}),loading:i,error:m,selectedProperty:u,filters:p,searchParams:e,setSelectedProperty:x,handleSearch:y,handleFilterChange:e=>{f(e);let t=new URL(window.location.href);e.priceRange[0]>0?t.searchParams.set("minPrice",e.priceRange[0].toString()):t.searchParams.delete("minPrice"),e.priceRange[1]<1e4?t.searchParams.set("maxPrice",e.priceRange[1].toString()):t.searchParams.delete("maxPrice"),"Any"!==e.bedrooms?t.searchParams.set("bedrooms",e.bedrooms):t.searchParams.delete("bedrooms"),"Any"!==e.bathrooms?t.searchParams.set("bathrooms",e.bathrooms):t.searchParams.delete("bathrooms");let s=Object.entries(e.amenities).filter(e=>{let[t,s]=e;return s}).map(e=>{let[t]=e;return t});s.length>0?t.searchParams.set("amenities",s.join(",")):t.searchParams.delete("amenities"),window.history.replaceState({},"",t.toString())},handleFilterReset:()=>{f({priceRange:[0,1e4],amenities:{elevator:!1,balcony:!1,dishwasher:!1},bedrooms:"Any",bathrooms:"Any"});let e=new URL(window.location.href);e.searchParams.delete("minPrice"),e.searchParams.delete("maxPrice"),e.searchParams.delete("bedrooms"),e.searchParams.delete("bathrooms"),e.searchParams.delete("amenities"),window.history.replaceState({},"",e.toString())},formatPrice:g,fetchProperties:y,setProperties:n}}(),{scrollDirection:X}=(0,w.C)(),K=(0,r.useMemo)(()=>{let t=e||(null==m?void 0:m.city);if(!t)return;let s=t.toString().toLowerCase(),a=F.K.find(e=>e.value===s);return(null==a?void 0:a.value)||s},[e,null==m?void 0:m.city]);(0,r.useEffect)(()=>{u(!0)},[]),(0,r.useEffect)(()=>{s.length>0&&!h&&(null==W||W(s))},[s,h,W]),(0,r.useEffect)(()=>{if(!h)return;let e=new URLSearchParams(window.location.search);K&&!e.has("city")&&e.set("city",K);let a=t?new URLSearchParams(t):new URLSearchParams,r=["city","from","to","guests"].every(t=>(e.get(t)||"")===(a.get(t)||""));if(s.length>0&&r){console.log("[SearchPageClient] Using SSR data, skipping initial fetch");return}console.log("[SearchPageClient] Fetching properties due to param change or no SSR data, params:",Object.fromEntries(e.entries())),O(e)},[h,t,s.length,K,O]);let $=(0,r.useMemo)(()=>b&&g?M.filter(e=>e.lat>=g.south&&e.lat<=g.north&&e.lng>=g.west&&e.lng<=g.east):M,[M,g,b]),Q=(0,r.useMemo)(()=>M.reduce((e,t)=>e+(t.listingUnits||1),0),[M]),H=(0,r.useMemo)(()=>{let e=$.reduce((e,t)=>e+(t.listingUnits||1),0);return console.log("[SearchPageClient] Properties status:",{filteredProperties:M.length,visibleProperties:$.length,visibleTotal:e,loading:A,error:D}),e},[$,M.length,A,D]),J=(0,r.useCallback)(e=>{let t=e.getNorthEast(),s=e.getSouthWest(),a={north:t.lat(),south:s.lat(),east:t.lng(),west:s.lng()};y(e=>e?.001>Math.abs(e.north-a.north)&&.001>Math.abs(e.south-a.south)&&.001>Math.abs(e.east-a.east)&&.001>Math.abs(e.west-a.west)?e:(v(!0),a):a)},[]),es=(0,r.useCallback)(()=>{S.current&&N(S.current.scrollTop>50)},[]),ea=(0,r.useCallback)(e=>{K&&e.set("city",K),console.log("[SearchPageClient] User initiated search with params:",Object.fromEntries(e.entries())),_(e)},[K,_]);return h?(0,a.jsx)("div",{className:"min-h-screen flex flex-col",style:{backgroundColor:"#FFFDF7"},children:(0,a.jsxs)("main",{className:"flex-grow relative",children:[(0,a.jsx)("div",{className:"pt-[88px]"}),(0,a.jsxs)("div",{className:(0,j.cn)("lg:hidden sticky top-[88px] z-20 bg-[#FFFDF7] transition-transform duration-300","down"===f?"-translate-y-full":"translate-y-0"),children:[(0,a.jsx)("div",{className:"border-b",style:{borderColor:"#5C5C5A20"},children:(0,a.jsx)("div",{className:"flex items-center justify-center p-3",children:(0,a.jsxs)("div",{className:"flex rounded-lg p-1",style:{backgroundColor:"#FFF9E9",border:"1px solid #5C5C5A20"},children:[(0,a.jsxs)(n.z,{variant:"ghost",size:"sm",onClick:()=>p("list"),onTouchEnd:e=>{e.preventDefault(),e.stopPropagation(),p("list")},className:"flex items-center gap-2 px-4 py-2 rounded-md transition-all touch-manipulation ".concat("list"===x?"shadow-sm":"hover:bg-transparent"),style:{backgroundColor:"list"===x?"#284E4C":"transparent",color:"list"===x?"#FFFDF6":"#5C5C5A"},children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:k("common.list")})]}),(0,a.jsxs)(n.z,{variant:"ghost",size:"sm",onClick:()=>p("map"),onTouchEnd:e=>{e.preventDefault(),e.stopPropagation(),p("map")},className:"flex items-center gap-2 px-4 py-2 rounded-md transition-all touch-manipulation ".concat("map"===x?"shadow-sm":"hover:bg-transparent"),style:{backgroundColor:"map"===x?"#284E4C":"transparent",color:"map"===x?"#FFFDF6":"#5C5C5A"},children:[(0,a.jsx)(o.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:k("common.map")})]})]})})}),"list"===x&&(0,a.jsx)("div",{className:"flex-shrink-0 border-b",style:{borderColor:"#5C5C5A20"},children:(0,a.jsx)(ee,{onSearch:ea,defaultValues:{location:K,guests:(null==E?void 0:E.get("guests"))?Number(E.get("guests")):void 0},filters:z,onFilterChange:B,onFilterReset:Z})})]}),(0,a.jsxs)("div",{className:"flex h-full lg:h-[calc(100vh-88px)]",children:[(0,a.jsx)("div",{className:"lg:hidden w-full flex flex-col",children:"list"===x?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{ref:S,onScroll:es,className:"flex-1 overflow-y-auto",style:{backgroundColor:"#FFFDF7"},children:(0,a.jsx)("div",{className:"p-4",children:A?(0,a.jsx)(Y.wY,{}):D?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"mb-4",style:{color:"#d32f2f"},children:D}),(0,a.jsx)(n.z,{onClick:()=>window.location.href="/",style:{backgroundColor:"#284E4C",color:"#FFFDF6"},className:"hover:opacity-90",children:(0,a.jsx)(et.Text,{children:"Modify Search"})})]}):K?0===M.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-xl mb-4",style:{color:"#5C5C5A"},children:(0,a.jsx)(et.Text,{children:"No properties found matching your criteria"})}),(0,a.jsx)(n.z,{onClick:()=>window.location.href="/",style:{backgroundColor:"#284E4C",color:"#FFFDF6"},className:"hover:opacity-90",children:(0,a.jsx)(et.Text,{children:"Modify Search"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm",style:{color:"#5C5C5A"},children:b&&g?H===Q?(0,a.jsx)(et.Text,{children:"".concat(Q.toString()," properties found")}):(0,a.jsx)(et.Text,{children:"".concat(H.toString()," of ").concat(Q.toString()," properties in current map view")}):(0,a.jsx)(et.Text,{children:"".concat(Q.toString()," properties found")})}),b&&g&&$.length<M.length&&(0,a.jsx)("p",{className:"text-xs mt-1",style:{color:"#5C5C5A"},children:(0,a.jsx)(et.Text,{children:"Zoom out or pan the map to see more properties"})})]}),(0,a.jsx)(I,{properties:$,selectedProperty:R,onSelectProperty:T,formatPrice:q})]}):(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-xl mb-4",style:{color:"#5C5C5A"},children:(0,a.jsx)(et.Text,{children:"Enter a location to start searching"})})})})})}):(0,a.jsx)("div",{className:"w-full h-[calc(100vh-160px)]",children:(0,a.jsx)(i.V,{properties:M,selectedProperty:R,onMarkerClick:T,formatPrice:q,onBoundsChanged:J})})}),(0,a.jsxs)("div",{className:"hidden lg:flex w-full",children:[(0,a.jsxs)("div",{className:"w-[60%] flex flex-col border-r",style:{borderColor:"#5C5C5A20"},children:[(0,a.jsx)("div",{className:"flex-shrink-0 border-b sticky top-[88px] z-10",style:{backgroundColor:"#FFFDF7",borderColor:"#5C5C5A20"},children:(0,a.jsx)(L,{onSearch:ea,defaultValues:{location:K,guests:(null==E?void 0:E.get("guests"))?Number(E.get("guests")):void 0},filters:z,onFilterChange:B,onFilterReset:Z,isPropertyListScrolled:C})}),(0,a.jsx)("div",{ref:S,onScroll:es,className:"flex-1 overflow-y-auto",style:{backgroundColor:"#FFFDF7"},children:(0,a.jsx)("div",{className:"p-4",children:A?(0,a.jsx)(Y.wY,{}):D?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"mb-4",style:{color:"#d32f2f"},children:D}),(0,a.jsx)(n.z,{onClick:()=>window.location.href="/",style:{backgroundColor:"#284E4C",color:"#FFFDF6"},className:"hover:opacity-90",children:(0,a.jsx)(et.Text,{children:"Modify Search"})})]}):K?0===M.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-xl mb-4",style:{color:"#5C5C5A"},children:(0,a.jsx)(et.Text,{children:"No properties found matching your criteria"})}),(0,a.jsx)(n.z,{onClick:()=>window.location.href="/",style:{backgroundColor:"#284E4C",color:"#FFFDF6"},className:"hover:opacity-90",children:(0,a.jsx)(et.Text,{children:"Modify Search"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm",style:{color:"#5C5C5A"},children:b&&g?H===Q?(0,a.jsx)(et.Text,{children:"".concat(Q.toString()," properties found")}):(0,a.jsx)(et.Text,{children:"".concat(H.toString()," of ").concat(Q.toString()," properties in current map view")}):(0,a.jsx)(et.Text,{children:"".concat(Q.toString()," properties found")})}),b&&g&&$.length<M.length&&(0,a.jsx)("p",{className:"text-xs mt-1",style:{color:"#5C5C5A"},children:(0,a.jsx)(et.Text,{children:"Zoom out or pan the map to see more properties"})})]}),(0,a.jsx)(I,{properties:$,selectedProperty:R,onSelectProperty:T,formatPrice:q})]}):(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-xl mb-4",style:{color:"#5C5C5A"},children:(0,a.jsx)(et.Text,{children:"Enter a location to start searching"})})})})})]}),(0,a.jsx)("div",{className:"w-[40%] relative",children:(0,a.jsx)("div",{className:"h-[calc(100vh-88px)] sticky top-[88px]",children:(0,a.jsx)(i.V,{properties:M,selectedProperty:R,onMarkerClick:T,formatPrice:q,onBoundsChanged:J})})})]})]}),K&&(0,a.jsx)(ei,{city:K})]})}):(0,a.jsx)(Y.wY,{})}function ed(e){let{initialCity:t,initialSearchParams:s,initialProperties:l=[]}=e,[o,n]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{n(!0)},[]),(0,a.jsx)(ec,{initialCity:t,initialSearchParams:s,initialProperties:l,isHydrated:o})}en.displayName=es.VY.displayName},19060:function(e,t,s){s.d(t,{X:function(){return i}});var a=s(57437),r=s(2265),l=s(9270),o=s(30401),n=s(94508);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.fC,{ref:t,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:(0,a.jsx)(l.z$,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})})})});i.displayName=l.fC.displayName},74928:function(e,t,s){s.d(t,{Fw:function(){return o},wy:function(){return l},zF:function(){return r}});var a=s(962);let r=a.fC,l=a.wy,o=a.Fw},17814:function(e,t,s){s.d(t,{OX:function(){return h},dy:function(){return n},iI:function(){return x},sc:function(){return m},uh:function(){return c},ze:function(){return u}});var a=s(57437),r=s(2265),l=s(4216),o=s(94508);let n=e=>{let{shouldScaleBackground:t=!0,...s}=e;return(0,a.jsx)(l.dy.Root,{shouldScaleBackground:t,...s})};n.displayName="Drawer",l.dy.Trigger;let i=l.dy.Portal,c=l.dy.Close,d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.dy.Overlay,{ref:t,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80",s),...r})});d.displayName=l.dy.Overlay.displayName;let m=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(i,{children:[(0,a.jsx)(d,{}),(0,a.jsxs)(l.dy.Content,{ref:t,className:(0,o.cn)("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",s),...n,children:[(0,a.jsx)("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),r]})]})});m.displayName="DrawerContent";let h=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,o.cn)("grid gap-1.5 p-4 text-center sm:text-left",t),...s})};h.displayName="DrawerHeader";let u=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,o.cn)("mt-auto flex flex-col gap-2 p-4",t),...s})};u.displayName="DrawerFooter";let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.dy.Title,{ref:t,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});x.displayName=l.dy.Title.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.dy.Description,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",s),...r})}).displayName=l.dy.Description.displayName},86978:function(e,t,s){s.d(t,{By:function(){return c},aN:function(){return n},wY:function(){return i}});var a=s(57437),r=s(94508),l=s(58130);let o={sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16"};function n(e){let{className:t,size:s="md",showText:n=!0}=e;return(0,a.jsxs)("div",{className:(0,r.cn)("flex flex-col items-center justify-center",t),children:[(0,a.jsx)(l.E.div,{animate:{rotate:360,scale:[1,1.1,1]},transition:{rotate:{duration:1.5,repeat:1/0,ease:"linear"},scale:{duration:1,repeat:1/0,ease:"easeInOut"}},className:(0,r.cn)(o[s],"relative"),children:(0,a.jsx)("svg",{viewBox:"0 0 446.38 500",className:"w-full h-full fill-primary",children:(0,a.jsx)("path",{d:"M446.38,248.79c-2.04-2.4-209.37-238.97-211.52-241.52l-6.36-7.27-6.66,7.26L5.98,242.46l-3.11,3.38-.06,4.87L0,499.02h30.36s-2.66-234.86-2.76-243.71c6.04-6.89,189.1-215.66,200.89-229.1l207.64,226.52c.03,3.87,1.53,231.85,1.58,239.38l-237.24.23v-187.27h52.61v-6.69h-52.61v-58.41c0-41.91,11.59-61.09,43.7-61.09,20.06,0,33,13.38,33,29.43,0,13.82-6.69,26.75-22.29,23.63v3.57c6.24,1.78,11.59,2.67,16.94,2.67,20.51,0,30.77-13.38,30.77-27.2,0-21.4-26.75-37.9-57.52-37.9-49.94,0-76.69,35.22-76.69,84.27v41.02h-32.1v6.69h32.1v187.27h-32.1v6.69l305.43.95,3.94.04v-3.99s.76-245.3.76-245.3c0,0,0-1.91,0-1.92Z"})})}),n&&(0,a.jsx)(l.E.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"mt-4 text-sm text-muted-foreground",children:"Loading..."})]})}function i(){return(0,a.jsx)("div",{className:"min-h-[50vh] flex items-center justify-center",children:(0,a.jsx)(n,{size:"lg"})})}function c(){return(0,a.jsx)("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,a.jsx)(n,{size:"lg"})})}},85897:function(e,t,s){s.d(t,{i:function(){return n}});var a=s(57437),r=s(2265),l=s(38846),o=s(94508);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsxs)(l.fC,{ref:t,className:(0,o.cn)("relative flex w-full touch-none select-none items-center",s),...r,children:[(0,a.jsx)(l.fQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,a.jsx)(l.e6,{className:"absolute h-full bg-primary"})}),(0,a.jsx)(l.bU,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 shadow-lg hover:shadow-xl cursor-pointer hover:scale-110",style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(40, 78, 76, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.8)"}}),(0,a.jsx)(l.bU,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 shadow-lg hover:shadow-xl cursor-pointer hover:scale-110",style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(40, 78, 76, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.8)"}})]})});n.displayName=l.fC.displayName},88685:function(e,t,s){s.d(t,{K:function(){return a}});let a=[{value:"london",label:"London, UK"},{value:"paris",label:"Paris, France"},{value:"algiers",label:"Algiers, Algeria"},{value:"lisbon",label:"Lisbon, Portugal"}]}}]);